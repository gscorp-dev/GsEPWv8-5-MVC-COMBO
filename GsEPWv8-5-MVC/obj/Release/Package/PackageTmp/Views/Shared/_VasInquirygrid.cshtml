@model GsEPWv8_5_MVC.Model.VasInquiryModel
@{
    var Ordercount = Model.ListVasInquiry.Count;
    decimal l_dec_tot_bill_amnt = 0;
}

@for (int j = 0; j < Model.ListVasInquiry.Count(); j++)
{
    var bill_amt = (Model.ListVasInquiry[j].TotAmount);
    decimal l_dec_bill_amnt = bill_amt;
    if (l_dec_bill_amnt > 0)
    {
        l_dec_tot_bill_amnt = l_dec_tot_bill_amnt + l_dec_bill_amnt;
    }
}
@Html.HiddenFor(model => model.screentitle)

<div class="gridSummary">
    <table style="width:100%;">
        <tr>
            <td style="width:16%;text-align: right;">
                <span style="font-size: 1.5em;color:#116b42;font-weight: bold;">
                    Total Records:
                </span>
                <label class="totalCount" style="text-align:left" id="TotalRecords">
                    @Ordercount
                </label>
            </td>
            <td style="width:74%;padding-left: 3%;">
                <span style="font-size: 1.5em;color:#116b42;font-weight: bold;">
                    TotalBill Amount:
                </span>
                <label class="totalCount" style="text-align:left" id="TotalBillAmt">
                    @l_dec_tot_bill_amnt.ToString("0.00")
                </label>
            </td>
        </tr>
    </table>
</div>
<br />
<div class="box box-primary">
    <div class="row">
        <table>
            <tr>
                @*<td style="width:83%;padding-left:10px;">
                        <span style="font-size: 1.5em;color:#ff5600;font-weight: bold;">
                            Total Records:
                        </span>
                        <label class="totalCount" style="text-align:left">
                            @Ordercount
                        </label>
                    </td>*@
                <td style=" width:105px;">
                    @*<div class="dropdown">
                            <button class="btn-Email" type="button" style=" width:100px; text-align:right;" id="btnEmail" data-toggle="dropdown">
                                Email
                                <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
                                <li role="presentation"><a role="menuitem" tabindex="-1" href="#">PDF</a></li>
                                <li role="presentation"><a role="menuitem" tabindex="-1" href="#">WORD</a></li>
                                <li role="presentation"><a role="menuitem" tabindex="-1" href="#">EXCEL</a></li>
                            </ul>
                        </div>*@
                </td>
                <td style="width:105px;">
                    @*<div class="dropdown">
                            <button class="btn-Print" type="button" id="btnPrint" style=" width:105px;" data-toggle="dropdown">
                                Print/View
                                <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu2">
                                <li role="presentation"><a role="menuitem" tabindex="-1" href="#" onclick="GetRes('');">PDF</a></li>
                                <li role="presentation"><a role="menuitem" tabindex="-1" href="#">WORD</a></li>
                                <li role="presentation"><a role="menuitem" tabindex="-1" href="#">EXCEL</a></li>
                            </ul>
                        </div>*@
                </td>
                <td>
                    @*<button type="button" id="btnClose" onclick="closeModal(); return false;" class="btn-Close">Close</button>*@

                </td>
            </tr>
        </table>

    </div>
    <br />
    <table id="GridVasInqPartial" class="table table-bordered table-striped" style="border:1px solid #121213 ;">

        <thead class="grid_backcolor">
            <tr>
                <th class="grid_header_backcolor" style="width:3%;">Sel</th>
                <th class="grid_header_backcolor" style="width:7%;">CustID</th>
                <th class="grid_header_backcolor" style="width:8%;">VASID</th>
                @if (Model.is_company_user == "Y")
                {
                    <th class="grid_header_backcolor" style="width:10%;">Action</th>
                }
                <th class="grid_header_backcolor" style="width:8%;">VASDate</th>
                <th class="grid_header_backcolor" style="width:8%;">SR#</th>
                <th class="grid_header_backcolor" style="width:7%;">Status</th>
                <th class="grid_header_backcolor" style="width:7%;">BillAmount</th>
                <th class="grid_header_backcolor" style="width:7%;">Vas Bill Status</th>
                <th class="grid_header_backcolor" style="width:35%;">Note</th>
                <th class="grid_header_backcolor" style="display:none;">BatchID</th>
               

            </tr>
        </thead>
        <tbody style="background-color:white">
            @for (int i = 0; i < Model.ListVasInquiry.Count; i++)
            {
                //int l_dec_bl_amt = 0;
                var bill_amt = (Model.ListVasInquiry[i].TotAmount);
                var l_dec_BillAmt = bill_amt.ToString("F2");
                
                int count = @Model.ListVasInquiry[i].upload_file_count;
                var l_str_staus = @Model.ListVasInquiry[i].Status.Trim();
                var l_str_vas_bill_status = (@Model.ListVasInquiry[i].vas_bill_status == null || @Model.ListVasInquiry[i].vas_bill_status == "") ? string.Empty : @Model.ListVasInquiry[i].vas_bill_status.Trim();
                <tr id="@Model.ListVasInquiry[i].VasID ">
                    <td style="text-align:center;"><input class="checkbox" id="chkdd_@i" data-id2="@Model.ListVasInquiry[i].Status" name="tblcheckbox" type="checkbox" value="@Model.ListVasInquiry[i].VasID" /></td>
                    <td style="font-size:12px; color:black; font-weight:bold;">@Model.ListVasInquiry[i].Cust_ID</td>
                    <td style="font-size:12px; color:black; font-weight:bold;"><a href="javascript:void(0);" class="VasDetail" style="text-decoration:underline; color:#034af3;" data-id="@Model.ListVasInquiry[i].VasID">@Model.ListVasInquiry[i].VasID</a></td>
                    @if (Model.is_company_user == "Y")
                    {
                        <td>
                            @if (@l_str_staus == "P")
                            {
                                <a></a>
                            }
                            else
                            {
                                <a href="javascript:void(0);" style="text-decoration:underline;color: blue;" class="VasEdit" data-id="@Model.ListVasInquiry[i].VasID" data-id1="@Model.ListVasInquiry[i].Cust_ID" data-id2="@Model.ListVasInquiry[i].Status" data-id3="@Model.ListVasInquiry[i].whs_id"><span class="glyphicon glyphicon-pencil" style="font-size: 18px;"></span><b>Edit</b></a>
                            }
                      
                              
                                    @if (@l_str_staus == "P")
                                    {
                                        <a></a>
                                    }
                                    else
                                    {
                                        <a href="javascript:void(0);" style="text-decoration:underline; color: red;" class="VasDelete" data-id="@Model.ListVasInquiry[i].VasID" data-id1="@Model.ListVasInquiry[i].vas_bill_status"><span class="glyphicon glyphicon-trash" style="font-size: 18px;"></span><b>Del</b></a>

                                    }
                              
                               
                                    @if (@l_str_staus == "O")
                                    {

                                        <a href="javascript:void(0);" style="text-decoration:underline; color: #59822c;font-size:12px;" class="VasPost" data-id="@Model.ListVasInquiry[i].VasID"><span style="font-size: 18px;"></span><b>Post</b></a>

                                    }
                                    else if (@l_str_staus == "P")
                                    {

                                        <a href="javascript:void(0);" style="text-decoration:underline; color: #59822c;font-size:12px;" class="VasUnPost" data-id="@Model.ListVasInquiry[i].VasID"><span style="font-size: 18px;"></span><b>Unpost</b></a>

                                    }
                                    else
                                    {
                                        <a></a>
                                    }

                            <a href="javascript:void(0);" style="text-decoration:underline; color: #ffd400;" class="clsVASDocUpload" data-id="@Model.ListVasInquiry[i].VasID"><span class="glyphicon glyphicon-file" style="font-size: 18px;"></span></a>
                            @if (count > 0)
                            {
                                <a href="javascript:void(0);" style="text-decoration:underline; color: orange;" class="clsVASDocUpload"  data-id="@Model.ListVasInquiry[i].VasID">(@count)</a>
                                <a href="javascript:void(0);" style="text-decoration:underline; color: blue;" class="clsVASDocSend" data-id="@Model.ListVasInquiry[i].VasID" ><span class="glyphicon glyphicon-envelope" style="font-size: 14px;"></span></a>
                            }
                                </td>
                    }
                    <td style="font-size:12px; color:black; font-weight:bold;">@Model.ListVasInquiry[i].VasDate</td>
                    <td style="font-size:12px; color:black; font-weight:bold;"><a href="javascript:void(0);" class="VasSRDetail" style="text-decoration:underline; color:#034af3;" data-id1="@Model.ListVasInquiry[i].quote_num" data-id="@Model.ListVasInquiry[i].so_num">@Model.ListVasInquiry[i].so_num</a></td>
                    @if (@Model.ListVasInquiry[i].Status.Trim() == "O")
                    {
                        <td style="font-size:12px; color:black; font-weight:bold;">OPEN</td>
                    }
                    else if (@Model.ListVasInquiry[i].Status.Trim() == "P")
                    {
                        <td style="font-size:12px; color:black; font-weight:bold;">POST</td>
                    }
                    <td style="font-size:12px; color:black; font-weight:bold; text-align :right;">@l_dec_BillAmt</td>

                    <td style="font-size:12px; color:black; font-weight:bold; text-align :left;">
                        @if (@l_str_vas_bill_status == "BILL")
                        {
                            <a href="javascript:void(0);" style="text-decoration:underline; color: #59822c;font-size:12px;" class="VasBillStatus" data-id="@Model.ListVasInquiry[i].cmp_id" data-id1="@Model.ListVasInquiry[i].VasID" data-id2="@Model.ListVasInquiry[i].VasDate"><span style="font-size: 18px;"></span><b>@Model.ListVasInquiry[i].vas_bill_status</b></a>

                        }
                        else if (@l_str_vas_bill_status == "TEMP")
                        {

                            <a href="javascript:void(0);" style="text-decoration:underline; color: #59822c;font-size:12px;" class="VasBillStatusInq" data-id="@Model.ListVasInquiry[i].cmp_id" data-id1="@Model.ListVasInquiry[i].VasID" data-id2="@Model.ListVasInquiry[i].VasDate" data-id3="@Model.ListVasInquiry[i].bill_doc_id"><span style="font-size: 18px;"></span><b>@Model.ListVasInquiry[i].bill_doc_id</b></a>

                        }
                        else if (@l_str_vas_bill_status == "")
                        {
                            <a></a>
                        }
                    </td>
                    <td style="font-size:12px; color:black; font-weight:bold; text-align :left;">@Model.ListVasInquiry[i].Note</td>
                    <td style="font-size:12px; color:black; font-weight:bold; text-align :right;display:none;">@Model.ListVasInquiry[i].quote_num</td>
                   

                </tr>

            }

        </tbody>

    </table>

</div>
<div id='VasModal' class='modal'>
    <div class="modal-dialog">
        <div class="modal-content" style="width: 198%; left:-160px;">
            <div id='myVASContent' style="width: 100%; height: 650px;"></div>
        </div>
    </div>

</div>
<div id='VasSRModal' class='modal'>
    <div class="modal-dialog">
        <div class="modal-content" style="width: 218%; left:-160px;">
            <div id='myVASSRContent' style="width: 100%; height: 650px;"></div>
        </div>
    </div>

</div>

<div id='myModalEdit' class='modal'>
    <div class="modal-dialog">
        <center>
            <div class="modal-content" style="width: 200%;left: -280px; ">
                <div id='myModalContentEdit' style="width: 1136px;height: 3000px;"></div>
            </div>
        </center>
    </div>
</div>

<div id='myModalDel' class='modal'>
    <div class="modal-dialog">
        <center>
            <div class="modal-content" style="width: 200%;left: -280px; ">

                <div id='myModalContentDel' style="width: 1136px;height: 855px;"></div>
            </div>
        </center>
    </div>
</div>

<div id='myModalVasBill' class='modal'>
    <div class="modal-dialog">
        <center>
            <div class="modal-content" style="width: 198%; ">
                <div id='myModalContentVasBill' style="width: 1140px;height: 655px;"></div>

            </div>
        </center>
    </div>

</div>
@*//CR_3PL_MVC_IB_2018_0317_001 Added By Soniya 17-03-2018*@
<div id='myModal' class='modal'>
    <div class="modal-dialog">
        <div class="modal-content" style="width: 198%; left:-160px;">
            <div id='myModalContent' style="width: 100%; height: 700px;"></div>
        </div>
    </div>

</div>

<div id='myModalEmailAlert' class='modal'>
    <div class="modal-dialog">
        <div class="modal-content" style="width: 250%; left:-400px;">
            <div id='myModalEmailAlertContent' style="width: 100%; height: 800px;"></div>
        </div>
    </div>

</div>

<script type="text/javascript">


    var p_str_cmp_id = $("#cmp_id").val();
    var TeamDetailOutboundfileURL = '/DocumentUpload/LoadVASDocuments';

    $(function () {
        //$(".Outboundfile").click(function () {
        $('#GridVasInqPartial tbody').on('click', '.clsVASDocUpload', function () {
            var $buttonClicked = $(this);
            var vasDocId = $buttonClicked.attr('data-id');
            var options = { "backdrop": "static", keyboard: true };
            var screentitle = $('#screentitle').val();

            $("#ajaxLoading").show();
            debugger
            $.ajax({
                type: "GET",
                url: TeamDetailOutboundfileURL,
                contentType: "application/json; charset=utf-8",
                data: { "p_str_cmp_id": p_str_cmp_id, "p_str_doc_id": vasDocId },
                datatype: "json",
                success: function (data) {
                    $("#ajaxLoading").hide();

                    $('#myModalVASDocUploadContent').html(data);
                    $('#myModalVASDocUpload').modal(options);
                    $('#myModalVASDocUpload').modal('show');

                },
                error: function () {
                    $("#ajaxLoading").hide();
                    swal("Dynamic content load failed.");
                }
            });
        });



        $('#GridVasInqPartial tbody').on('click', '.clsVASDocSend', function () {
            var $buttonClicked = $(this);
            UrlEmailDocuments = '/DocumentUpload/EmailDocuments';
            var vasDocId = $buttonClicked.attr('data-id');
            var p_str_cmp_id = $('#cmp_id').val();
            var p_str_cntr_id = '';
            var p_str_cust_name = '';
            var p_str_cust_po_num = '';
            var options = { "backdrop": "static", keyboard: true };
            var screentitle = $('#screentitle').val();

            $("#ajaxLoading").show();
            debugger
            $.ajax({
                type: "GET",
                url: UrlEmailDocuments,
                contentType: "application/json; charset=utf-8",
                data: { "p_str_cmp_id": p_str_cmp_id, "p_str_doc_id": vasDocId, "p_str_cntr_id": p_str_cntr_id, "p_str_cust_name": p_str_cust_name, "p_str_cust_po_num": p_str_cust_po_num },
                datatype: "json",
                success: function (data) {
                    $("#ajaxLoading").hide();
                    $('#myModalEmailAlertContent').html(data);
                    $('#myModalEmailAlert').modal(options);
                    $('#myModalEmailAlert').modal('show');

                },
                error: function () {
                    $("#ajaxLoading").hide();
                    swal("Dynamic content load failed.");
                }
            });
        });




    });


</script>

<script type="text/javascript">
    var cmp_id = $("#cmp_id").val();
    var TeamDetailPostBackURL = '/VasInquiry/VasDetail';

    $(function () {
        //$(".VasDetail").click(function () {
        $('#GridVasInqPartial tbody').on('click', '.VasDetail', function () {//CR2018-04-07-001 Added by Nithya

            var $buttonClicked = $(this);
            var VasId = $buttonClicked.attr('data-id');
            var options = { "backdrop": "static", keyboard: true };
            $.ajax({
                type: "GET",
                url: TeamDetailPostBackURL,
                contentType: "application/json; charset=utf-8",
                data: { "VasId": VasId, "cmp_id": cmp_id },
                datatype: "json",
                success: function (data) {
                    $('#myVASContent').html(data);
                    $('#VasModal').modal(options);
                    $('#VasModal').modal('show');

                },
                error: function () {
                    swal("", "Dynamic content load failed.", "");
                    //alert("Dynamic content load failed.");
                }
            });



        });
        $("#closbtn").click(function () {
            $('#myModal').modal('hide');
        });
    });

    var cmp_id = $("#cmp_id").val();
    var ShippingBackURL = '/VasInquiry/VasSRDetail';

    $(function () {
        //$(".VasSRDetail").click(function () {
        $('#GridVasInqPartial tbody').on('click', '.VasSRDetail', function () {//CR2018-04-07-001 Added by Nithya

            var $buttonClicked = $(this);
            var SRId = $buttonClicked.attr('data-id');
            var BatchId = $buttonClicked.attr('data-id1');
            var options = { "backdrop": "static", keyboard: true };
            $.ajax({
                type: "GET",
                url: ShippingBackURL,
                contentType: "application/json; charset=utf-8",
                data: { "SRId": SRId, "cmp_id": cmp_id, "BatchId": BatchId },
                datatype: "json",
                success: function (data) {
                    if (data == 0) {
                        sweetAlert("", "No Ship Request Details Found.", "");
                    }
                    else {
                        $('#myVASSRContent').html(data);
                        $('#VasSRModal').modal(options);
                        $('#VasSRModal').modal('show');
                    }

                },
                error: function () {
                    swal("", "Dynamic content load failed.", "");
                }
            });



        });
        $("#closbtn").click(function () {
            $('#myModal').modal('hide');
        });
    });

    var x = $('#TotalRecords').val();
    var y = $('#TotalBillAmt').val();
    $('#TotalRecords').val(addCommas(x));
    $('#TotalBillAmt').val(addCommas(y));
    function addCommas(x) {
        var totamount = document.getElementById("GridVasInqPartial")
        var parts = x.toString().split(".");
        parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        return parts.join(".");
    }
    $(function () {

        $('#GridVasInqPartial').DataTable({
            "lengthChange": true,
            "pageLength": 50,
            "searching": true,
            "ordering": true,
            "info": true,
            "autoWidth": true,
            "scrollCollapse": true,
            "sScrollY": "460px",
            "sScrollX": "100%",
        });
    })

    $("#example1 tr").not(':first').hover(
function () {
    $(this).css("background", "#dcf4ff");
},
function () {
    $(this).css("background", "white");
}
);
    $("#example2 tr").not(':first').hover(
function () {
    $(this).css("background", "#dcf4ff");
},
function () {
    $(this).css("background", "white");
}
);
    $("#btnClose").click(function () {

        window.location.href = '@Url.Action("Dashboard", "DashBoard")';
    })

    $("input[name=chkAll").click(function () {
        if ($(this).prop("checked") == true) {

            $("input[name='tblcheckbox']").prop("checked", true);
        }
        else if ($(this).prop("checked") == false) {

            $("input[name='tblcheckbox']").prop("checked", false);
        }
    });
    $("input[name='tblcheckbox']").click(function () {

        if ($("input[name='tblcheckbox']").length == $("input[name='tblcheckbox']:checked").length) {
            $("#chkAll").prop("checked", true);
        }
        else {
            $("#chkAll").prop("checked", false);
        }

    });
    $("input[name='tblcheckbox']").on('change', function () {
        $("input[name='tblcheckbox']").not(this).prop('checked', false);
    });
    $("#btnprocesss").click(function () {
        debugger
        var getFormat = $('#id_format').find(":selected").text();
        var getMode = $('#id_mode').find(":selected").text();

        if (getFormat == 'XLS' && getMode == 'EXPORT') {
            var type = "Excel";
            var SelectedRow = [];
            var checkboxIDArray = [];
            var var_name = $("input[name='radio1']:checked").val();
            debugger;
            if (var_name == "Vas Inquiry Report") {
                debugger
                var p_str_cmp_id = $('#cmp_id').val();
                var p_str_radio = var_name;
                var p_str_vas_id_fm = $('#vas_id_fm').val();
                var p_str_vas_id_to = $('#vas_id_to').val();
                var p_str_vas_date_fm = $('#vas_date_fm').val();
                var p_str_vas_date_to = $('#vas_date_to').val();
                var p_str_so_num = $('#so_num').val();
                var p_str_Status = $('#Status').val();

                window.location.replace("/VasInquiry/ShowReport?p_str_cmp_id=" + p_str_cmp_id + '&p_str_radio=' + p_str_radio + '&p_str_vas_id_fm=' + p_str_vas_id_fm
          + '&p_str_vas_id_to=' + p_str_vas_id_to + '&p_str_vas_date_fm=' + p_str_vas_date_fm + '&p_str_vas_date_to=' + p_str_vas_date_to + '&p_str_so_num=' + p_str_so_num
          + '&p_str_Status=' + p_str_Status + '&SelectedID=' + SelectdID + '&type=' + type)

            }
            else {
                var numberOfCheckboxes = $("input[name='tblcheckbox']:checked").length;
                if (numberOfCheckboxes == 0) {
                    swal("", "Please select the Record to Print.", "");
                    //not2("Please select the Record to Print.");
                }
                else {
                    $("input[name='tblcheckbox']:checked").each(function () {
                        var check = $(this);
                        if (check.is(':checked')) {
                            checkboxIDArray.push(check.attr('id'));
                            SelectedRow.push(check.val());
                        }
                    });
                    debugger;
                    var Count = $("input[name='tblcheckbox']:checked").length;
                    if (Count > 0) {
                        debugger;
                        var SelectdID = '';
                        $.each(SelectedRow, function (i, v) {

                            if (SelectdID == '')
                                SelectdID = v;
                            else
                                SelectdID = SelectdID + ',' + v;

                        });
                        var var_name = $("input[name='radio1']:checked").val();
                        var p_str_cmpid = $('#cmp_id').val();
                        var p_str_radio = var_name;


                        window.location.replace("/VasInquiry/ShowReport?p_str_cmp_id=" + p_str_cmpid + '&p_str_radio=' + p_str_radio + '&p_str_vas_id_fm=' + p_str_vas_id_fm
       + '&p_str_vas_id_to=' + p_str_vas_id_to + '&p_str_vas_date_fm=' + p_str_vas_date_fm + '&p_str_vas_date_to=' + p_str_vas_date_to + '&p_str_so_num=' + p_str_so_num
       + '&p_str_Status=' + p_str_Status + '&SelectedID=' + SelectdID + '&type=' + type)

                    }
                    else {

                        $("input:checkbox").each(function () {
                            var check = $(this);
                            if (check.is(':checked')) {
                                this.checked = !this.checked;
                            }
                        });

                    }

                }
            }


        }
        if (getFormat == 'PDF' && getMode == 'VIEW') {
            debugger
            var type = "PDF";
            var SelectedRow = [];
            var checkboxIDArray = [];
            var var_name = $("input[name='radio1']:checked").val();
            debugger;
            if (var_name == "Vas Inquiry Report") {
                debugger
                var p_str_cmp_id = $('#cmp_id').val();
                var p_str_radio = var_name;
                var p_str_vas_id_fm = $('#vas_id_fm').val();
                var p_str_vas_id_to = $('#vas_id_to').val();
                var p_str_vas_date_fm = $('#vas_date_fm').val();
                var p_str_vas_date_to = $('#vas_date_to').val();
                var p_str_so_num = $('#so_num').val();
                var p_str_Status = $('#Status').val();
                debugger;
                window.open('ShowReport?p_str_cmp_id=' + p_str_cmp_id + '&p_str_radio=' + p_str_radio + '&p_str_vas_id_fm=' + p_str_vas_id_fm
           + '&p_str_vas_id_to=' + p_str_vas_id_to + '&p_str_vas_date_fm=' + p_str_vas_date_fm + '&p_str_vas_date_to=' + p_str_vas_date_to + '&p_str_so_num=' + p_str_so_num
           + '&p_str_Status=' + p_str_Status + '&SelectedID=' + SelectdID + '&type=' + type, 'VasInquiry', "toolbar=no, scrollbars=yes, resizable=yes, top=200, left=500, width=950, height=700", 'ShowReport' + p_str_radio)



            }
            else {
                var numberOfCheckboxes = $("input[name='tblcheckbox']:checked").length;
                if (numberOfCheckboxes == 0) {
                    swal("", "Please select the Record to Print.", "");
                }
                else {
                    $("input[name='tblcheckbox']:checked").each(function () {
                        var check = $(this);
                        if (check.is(':checked')) {
                            checkboxIDArray.push(check.attr('id'));
                            SelectedRow.push(check.val());
                        }
                    });
                    debugger;
                    var Count = $("input[name='tblcheckbox']:checked").length;
                    if (Count > 0) {
                        debugger;
                        var SelectdID = '';
                        $.each(SelectedRow, function (i, v) {

                            if (SelectdID == '')
                                SelectdID = v;
                            else
                                SelectdID = SelectdID + ',' + v;

                        });
                        var var_name = $("input[name='radio1']:checked").val();
                        var p_str_cmpid = $('#cmp_id').val();
                        var p_str_radio = var_name;

                        window.open('ShowReport?p_str_cmp_id=' + p_str_cmpid + '&p_str_radio=' + p_str_radio + '&p_str_vas_id_fm=' + p_str_vas_id_fm
+ '&p_str_vas_id_to=' + p_str_vas_id_to + '&p_str_vas_date_fm=' + p_str_vas_date_fm + '&p_str_vas_date_to=' + p_str_vas_date_to + '&p_str_so_num=' + p_str_so_num
+ '&p_str_Status=' + p_str_Status + '&SelectedID=' + SelectdID + '&type=' + type, 'VasInquiry', "toolbar=no, scrollbars=yes, resizable=yes, top=200, left=500, width=950, height=700", 'ShowReport' + p_str_radio)



                    }
                    else {

                        $("input:checkbox").each(function () {
                            var check = $(this);
                            if (check.is(':checked')) {
                                this.checked = !this.checked;
                            }
                        });

                    }

                }
            }

        }
        if (getFormat == 'PDF' && getMode == 'EMAIL') {
            var options = { "backdrop": "static", keyboard: true };
            var TeamDetailPostemailBackURL = '/VasInquiry/EmailShowReport';
            var type = "PDF";
            var SelectedRow = [];
            var checkboxIDArray = [];
            var var_name = $("input[name='radio1']:checked").val();
            debugger;
            if (var_name == "Vas Inquiry Report") {
                debugger
                var p_str_radio = var_name;
                //var type = getli;
                var p_str_cmp_id = $('#cmp_id').val();
                var p_str_radio = var_name;
                var p_str_vas_id_fm = $('#vas_id_fm').val();
                var p_str_vas_id_to = $('#vas_id_to').val();
                var p_str_vas_date_fm = $('#vas_date_fm').val();
                var p_str_vas_date_to = $('#vas_date_to').val();
                var p_str_so_num = $('#so_num').val();
                var p_str_Status = $('#Status').val();
                debugger;
                //     window.open('ShowReport?p_str_cmp_id=' + p_str_cmp_id + '&p_str_radio=' + p_str_radio + '&p_str_vas_id_fm=' + p_str_vas_id_fm
                //+ '&p_str_vas_id_to=' + p_str_vas_id_to + '&p_str_vas_date_fm=' + p_str_vas_date_fm + '&p_str_vas_date_to=' + p_str_vas_date_to + '&p_str_so_num=' + p_str_so_num
                //+ '&p_str_Status=' + p_str_Status + '&SelectedID=' + SelectdID + '&type=' + type, 'VasInquiry', "toolbar=no, scrollbars=yes, resizable=yes, top=200, left=500, width=950, height=700", 'ShowReport' + p_str_radio)

                $.ajax({
                    type: "GET",
                    url: TeamDetailPostemailBackURL,
                    contentType: "application/json; charset=utf-8",
                    data: {
                        "p_str_cmp_id": p_str_cmp_id, "p_str_radio": p_str_radio, "p_str_vas_id_fm": p_str_vas_id_fm,
                        "p_str_vas_id_to": p_str_vas_id_to, "p_str_vas_date_fm": p_str_vas_date_fm, "p_str_vas_date_to": p_str_vas_date_to, "p_str_so_num": p_str_so_num,
                        "p_str_Status": p_str_Status, "type": type
                    },
                    datatype: "json",
                    success: function (data) {
                        $('#myModalEmailContent').html(data);
                        $('#myModalEmail').modal(options);
                        $('#myModalEmail').modal('show');

                    },
                    error: function () {
                        alert("Dynamic content load failed.");
                    }
                });

            }
            else {
                var numberOfCheckboxes = $("input[name='tblcheckbox']:checked").length;
                if (numberOfCheckboxes == 0) {
                    swal("", "Please select the Record to Print.", "");
                }
                else {
                    $("input[name='tblcheckbox']:checked").each(function () {
                        var check = $(this);
                        if (check.is(':checked')) {
                            checkboxIDArray.push(check.attr('id'));
                            SelectedRow.push(check.val());
                        }
                    });
                    debugger;
                    var Count = $("input[name='tblcheckbox']:checked").length;
                    if (Count > 0) {
                        debugger;
                        var SelectdID = '';
                        $.each(SelectedRow, function (i, v) {

                            if (SelectdID == '')
                                SelectdID = v;
                            else
                                SelectdID = SelectdID + ',' + v;

                        });
                        var var_name = $("input[name='radio1']:checked").val();
                        var p_str_cmpid = $('#cmp_id').val();
                        var p_str_radio = var_name;

                        //                        window.open('ShowReport?p_str_cmp_id=' + p_str_cmpid + '&p_str_radio=' + p_str_radio + '&p_str_vas_id_fm=' + p_str_vas_id_fm
                        //+ '&p_str_vas_id_to=' + p_str_vas_id_to + '&p_str_vas_date_fm=' + p_str_vas_date_fm + '&p_str_vas_date_to=' + p_str_vas_date_to + '&p_str_so_num=' + p_str_so_num
                        //+ '&p_str_Status=' + p_str_Status + '&SelectedID=' + SelectdID + '&type=' + type, 'VasInquiry', "toolbar=no, scrollbars=yes, resizable=yes, top=200, left=500, width=950, height=700", 'ShowReport' + p_str_radio)

                        $.ajax({
                            type: "GET",
                            url: TeamDetailPostemailBackURL,
                            contentType: "application/json; charset=utf-8",
                            data: {
                                "p_str_cmp_id": p_str_cmp_id, "p_str_radio": p_str_radio, "p_str_vas_id_fm": p_str_vas_id_fm,
                                "p_str_vas_id_to": p_str_vas_id_to, "p_str_vas_date_fm": p_str_vas_date_fm, "p_str_vas_date_to": p_str_vas_date_to, "p_str_so_num": p_str_so_num,
                                "p_str_Status": p_str_Status, "SelectedID": SelectedID, "type": type
                            },
                            datatype: "json",
                            success: function (data) {
                                $('#myModalEmailContent').html(data);
                                $('#myModalEmail').modal(options);
                                $('#myModalEmail').modal('show');

                            },
                            error: function () {
                                alert("Dynamic content load failed.");
                            }
                        });

                    }
                    else {

                        $("input:checkbox").each(function () {
                            var check = $(this);
                            if (check.is(':checked')) {
                                this.checked = !this.checked;
                            }
                        });

                    }

                }
            }
        }


    })
    $("#btnSearch").click(function () {
        location.reload();
    });

    $('#example4').DataTable({
        //"paging": true,
        "lengthChange": false,
        "searching": false,
        "ordering": true,
        "info": true,
        "autoWidth": false,
        "scrollCollapse": true,
        "sScrollY": "100%",
        "sScrollX": "100%",
    });
    @*function closeModal() {
                $.ajax({
                    //url: AppVirtualPath + '/Users/DeleteUsers',
                    url: '@Url.Action("TruncateTempVasEntry", "VasInquiry")',
                    type: 'GET',
                    cache: false,
                    success: function (data) {
                        if (data > 0) {
                            //alert('d')
                        }
                    }
                });
            }*@
    var cmp_id = $("#cmp_id").val();
    var TeamDetailPostBackDelURL = '/VasInquiry/Delete';
    $(function () {
        debugger
        //$(".VasDelete").click(function () {
        $('#GridVasInqPartial tbody').on('click', '.VasDelete', function () {//CR2018-04-07-001 Added by Nithya
            debugger
            var $buttonClicked = $(this);
            var p_str_vas_id = $buttonClicked.attr('data-id');
            var p_str_vas_bill_status = $buttonClicked.attr('data-id1');
            var p_str_scn_id = $('#screentitle').val();
            var options = { "backdrop": "static", keyboard: true };
            $("#ajaxLoading").show();
            var p_str_cmp_id = $('#cmp_id').val();
            var p_str_vas_id_fm = $('#vas_id_fm').val();
            var p_str_vas_id_to = $('#vas_id_to').val();
            var p_str_ship_vas_date_fm = $('#vas_date_fm').val();
            var p_str_vas_date_to = $('#vas_date_to').val();
            var p_str_so_num = $('#so_num').val();
            var p_str_Status = $('#Status').val();

            $.ajax({
                type: "GET",
                url: '@Url.Content("~/VasInquiry/VAS_INQ_HDR_DATA")',
                data: {
                    "p_str_cmp_id": p_str_cmp_id, "p_str_vas_id_fm": p_str_vas_id_fm, "p_str_vas_id_to": p_str_vas_id_to, "p_str_ship_vas_date_fm": p_str_ship_vas_date_fm,
                    "p_str_vas_date_to": p_str_vas_date_to, "p_str_so_num": p_str_so_num, "p_str_Status": p_str_Status

                },

                dataType: "json",
                success: function (e) {
                    //alert(e)

                },

            });
            $.ajax({
                type: "GET",
                url: TeamDetailPostBackDelURL,
                contentType: "application/json; charset=utf-8",
                data: { "p_str_vas_id": p_str_vas_id, "cmp_id": cmp_id, "p_str_vas_bill_status": p_str_vas_bill_status, "p_str_scn_id": p_str_scn_id },
                datatype: "json",
                success: function (data) {
                    $("#ajaxLoading").hide();
                    $('#myModalContentDel').html(data);
                    $('#myModalDel').modal(options);
                    $('#myModalDel').modal('show');

                },
                error: function () {
                    swal("", "Dynamic content load failed.", "");
                    //alert("Dynamic content load failed.");
                }
            });



        });
        $("#closbtn").click(function () {
            $('#myModal').modal('hide');
        });
    });

    var cmp_id = $("#cmp_id").val();
    var TeamDetailPostBackPostURL = '/VasInquiry/Post';
    $(function () {
        //$(".VasPost").click(function () {
        $('#GridVasInqPartial tbody').on('click', '.VasPost', function () {//CR2018-04-07-001 Added by Nithya
            var $buttonClicked = $(this);
            var VasId = $buttonClicked.attr('data-id');
            var p_str_scn_id = $('#screentitle').val();
            var options = { "backdrop": "static", keyboard: true };
            $("#ajaxLoading").show();
            var p_str_cmp_id = $('#cmp_id').val();
            var p_str_vas_id_fm = $('#vas_id_fm').val();
            var p_str_vas_id_to = $('#vas_id_to').val();
            var p_str_ship_vas_date_fm = $('#vas_date_fm').val();
            var p_str_vas_date_to = $('#vas_date_to').val();
            var p_str_so_num = $('#so_num').val();
            var p_str_Status = $('#Status').val();

            $.ajax({
                type: "GET",
                url: '@Url.Content("~/VasInquiry/VAS_ID_INQ_HDR_DATA")',
                data: {
                    "p_str_cmp_id": p_str_cmp_id, "p_str_vas_id_fm": p_str_vas_id_fm, "p_str_vas_id_to": p_str_vas_id_to, "p_str_vas_date_fm": p_str_ship_vas_date_fm,
                    "p_str_vas_date_to": p_str_vas_date_to, "p_str_so_num": p_str_so_num, "p_str_Status": p_str_Status, "p_str_Screen": p_str_scn_id

                },

                dataType: "json",
                success: function (e) {
                    //alert(e)

                },

            });
            $.ajax({
                type: "GET",
                url: TeamDetailPostBackPostURL,
                contentType: "application/json; charset=utf-8",
                data: { "VasId": VasId, "cmp_id": cmp_id, "p_str_scn_id": p_str_scn_id },
                datatype: "json",
                success: function (data) {
                    $("#ajaxLoading").hide();
                    $('#myModalContentDel').html(data);
                    $('#myModalDel').modal(options);
                    $('#myModalDel').modal('show');

                },
                error: function () {
                    swal("", "Dynamic content load failed.", "");
                    //alert("Dynamic content load failed.");
                }
            });



        });
        $("#closbtn").click(function () {
            $('#myModal').modal('hide');
        });
    });
    var cmp_id = $("#cmp_id").val();
    var TeamDetailPostBackEditURL = '/VasInquiry/Edit';
    $(function () {
        //$(".VasEdit").click(function () {
        $('#GridVasInqPartial tbody').on('click', '.VasEdit', function () {//CR2018-04-07-001 Added by Nithya

            debugger
            var $buttonClicked = $(this);
            var VasId = $buttonClicked.attr('data-id');
            var CmpId = $buttonClicked.attr('data-id1');
            var gridstatus = $buttonClicked.attr('data-id2');
            var p_str_whs_id = $buttonClicked.attr('data-id3');
            var p_str_scn_id = $('#screentitle').val();
          
            if (gridstatus != "P") {
                var options = { "backdrop": "static", keyboard: true };
                $("#ajaxLoading").show();
                var p_str_cmp_id = $('#cmp_id').val();
                var p_str_vas_id_fm = $('#vas_id_fm').val();
                var p_str_vas_id_to = $('#vas_id_to').val();
                var p_str_ship_vas_date_fm = $('#vas_date_fm').val();
                var p_str_vas_date_to = $('#vas_date_to').val();
                var p_str_so_num = $('#so_num').val();
                var p_str_Status = $('#Status').val();

                $.ajax({
                    type: "GET",
                    url: '@Url.Content("~/VasInquiry/VAS_INQ_HDR_DATA")',
                    data: {
                        "p_str_cmp_id": p_str_cmp_id, "p_str_vas_id_fm": p_str_vas_id_fm, "p_str_vas_id_to": p_str_vas_id_to, "p_str_ship_vas_date_fm": p_str_ship_vas_date_fm,
                        "p_str_vas_date_to": p_str_vas_date_to, "p_str_so_num": p_str_so_num, "p_str_Status": p_str_Status

                    },

                    dataType: "json",
                    success: function (e) {
                        //alert(e)

                    },

                });
                $.ajax({
                    type: "GET",
                    url: TeamDetailPostBackEditURL,
                    contentType: "application/json; charset=utf-8",
                    data: { "VasId": VasId, "CmpId": CmpId, "p_str_scn_id": p_str_scn_id, "p_str_whs_id": p_str_whs_id },
                    datatype: "json",
                    success: function (data) {
                        $("#ajaxLoading").hide();
                        $('#myModalContentEdit').html(data);
                        $('#myModalEdit').modal(options);
                        $('#myModalEdit').modal('show');

                    },
                    error: function () {
                        swal("", "Dynamic content load failed.", "");
                        //alert("Dynamic content load failed.");
                    }
                });

            }
            else {

                swal("VAS Id Already Posted, Couldn't Modify")
            }




        });
        $("#closbtn").click(function () {
            $('#myModal').modal('hide');
        });
    });

    var p_str_cmp_id = $("#cmp_id").val();
    var TeamDetailPostBackUnPostURL = '/VasInquiry/UnPost';
    $(function () {
        //$(".VasUnPost").click(function () {
        $('#GridVasInqPartial tbody').on('click', '.VasUnPost', function () {//CR2018-04-07-001 Added by Nithya
            var $buttonClicked = $(this);
            var p_str_vas_id = $buttonClicked.attr('data-id');
            var p_str_bill_doc_id = $buttonClicked.attr('data-id1');
            var p_str_scn_id = $('#screentitle').val();
            var options = { "backdrop": "static", keyboard: true };
            $("#ajaxLoading").show();
            var p_str_cmp_id = $('#cmp_id').val();
            var p_str_vas_id_fm = $('#vas_id_fm').val();
            var p_str_vas_id_to = $('#vas_id_to').val();
            var p_str_ship_vas_date_fm = $('#vas_date_fm').val();
            var p_str_vas_date_to = $('#vas_date_to').val();
            var p_str_so_num = $('#so_num').val();
            var p_str_Status = $('#Status').val();

            $.ajax({
                type: "GET",
                url: '@Url.Content("~/VasInquiry/VAS_INQ_HDR_DATA")',
                data: {
                    "p_str_cmp_id": p_str_cmp_id, "p_str_vas_id_fm": p_str_vas_id_fm, "p_str_vas_id_to": p_str_vas_id_to, "p_str_ship_vas_date_fm": p_str_ship_vas_date_fm,
                    "p_str_vas_date_to": p_str_vas_date_to, "p_str_so_num": p_str_so_num, "p_str_Status": p_str_Status

                },

                dataType: "json",
                success: function (e) {
                    //alert(e)

                },
            });
            $.ajax({
                type: "GET",
                url: TeamDetailPostBackUnPostURL,
                contentType: "application/json; charset=utf-8",
                data: { "p_str_vas_id": p_str_vas_id, "p_str_cmp_id": p_str_cmp_id, "p_str_bill_doc_id": p_str_bill_doc_id, "p_str_scn_id": p_str_scn_id },
                datatype: "json",
                success: function (data) {
                    $("#ajaxLoading").hide();
                    $('#myModalContentDel').html(data);
                    $('#myModalDel').modal(options);
                    $('#myModalDel').modal('show');

                },
                error: function () {
                    swal("", "Dynamic content load failed.", "");
                    //alert("Dynamic content load failed.");
                }
            });



        });
        $("#closbtn").click(function () {
            $('#myModal').modal('hide');
        });
    });
    $("#btnUpdateVas").click(function () {
        debugger
        var p_str_cmp_id = $('#cmp_id').val();
        var p_str_vas_id = $('#vas_id').val();
        var p_str_vas_dt = $('#ship_dt').val();
        var p_str_so_num = $('#Vassonum').val();
        var p_str_whs_id = $('#whs_id').val();
        var p_str_ship_to_id = $('#ship_to_id').val();
        var p_str_cust_po_num = $('#cust_po_num').val();
        var p_str_cust_po_dt = $('#cust_po_dt').val();
        var p_str_note = $('#Note').val();
        var p_str_check_value = $('#two').val();
        var objVASHdr = {};
        objVASHdr.cmp_id = $('#new_cmp_id').val();
        objVASHdr.vas_id = $('#vas_id').val();
        objVASHdr.vas_dt = $('#ship_dt').val();
        objVASHdr.so_num = $('#Vassonum').val();
        objVASHdr.whs_id = $('#VaswhsId').val();
        objVASHdr.ship_to_id = $('#ship_to_id').val();
        objVASHdr.cust_po_num = $('#cust_po_num').val();
        objVASHdr.cust_po_dt = $('#cust_po_dt').val();
        objVASHdr.note = $('#Note').val();
        var VASHdr = new Array();
        VASHdr.push(objVASHdr);
        var numberOfCheckboxes = $("input[name='attribute1']:checked").length;
        if (numberOfCheckboxes == 0) {
            swal("", "No Item Added.", "");
            return false;
        }
        $("#ajaxloading").show();
        var VasdtlCount = $("#Count_Values").val();
        var ItemDetails = new Array();
        for (var i = 0; i < VasdtlCount; i++) {

            var l_int_qty = $("#qty_" + i).val();
            var l_dec_price = $("#price_" + i).val();
            var l_dec_Amount = $("#amt_" + i).val();
            var l_str_itmnum = $("#itmnum_" + i).val();
            var l_str_note = $("#Note_" + i).val();
            var l_str_itnname = $("#itm_name_" + i).val();
            var l_str_priceuom = $("#price_uom_" + i).val();
            if (l_int_qty == "") {
                l_int_qty = 0;
            }
            else if (l_int_qty == undefined) {
                l_int_qty = 0;
            }
            if (l_dec_price == "") {
                l_dec_price = 0;
            }
            else if (l_dec_price == undefined) {
                l_dec_price = 0;
            }
            if (l_int_qty != 0) {
                var ItemDetail = {};
                ItemDetail.qty = l_int_qty;
                ItemDetail.list_price = l_dec_price;
                ItemDetail.amt = l_dec_Amount;
                ItemDetail.itm_num = l_str_itmnum;
                ItemDetail.notes = l_str_note;
                ItemDetail.itm_name = l_str_itnname;
                ItemDetail.price_uom = l_str_priceuom;
                ItemDetails.push(ItemDetail);
            }
        }
        if (p_str_cmp_id == "") {
            swal("", "Please Select The Company.", "");
            $('#cmp_id').focus();
            $('body,html').animate({ scrollTop: 0 }, 0);
            er = 1;
            return false;
        }
        else {
            $.ajax({
                type: "POST",
                url: '@Url.Content("~/VasInquiry/UpdateVasEntry")',
                data: JSON.stringify({ ItemDetails: ItemDetails, VASHdr: VASHdr }),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (e) {
                    $("#ajaxLoading").hide();
                    debugger
                    if (e > 0) {
                        swal({
                            title: "",
                            text: "No Records to Save",       //CR - 3PL-MVC-VAS-20180505 Added by Soniya
                            type: "",
                            showCancelButton: false,
                            confirmButtonClass: "btn-danger",
                            confirmButtonText: "Ok",
                            closeOnConfirm: true
                        });
                    }
                    else {
                        debugger
                        swal({
                            title: "",
                            text: "VASId " + p_str_vas_id + " Updated successfully.",
                            type: "",
                            showCancelButton: false,
                            confirmButtonClass: "btn-danger",
                            confirmButtonText: "Ok",
                            closeOnConfirm: true
                        },
                        //swal("", "Your record Added successfully.", "");
                        function () {
                            debugger
                            setTimeout(function () {
                                var p_str_screen_title = $('#screentitle').val();
                                var p_str_cmpid = $('#new_cmp_id').val();
                                var p_str_vasid = $('#vas_id').val();
                                var SelectedID = p_str_vasid;
                                var type = "PDF";
                                var var_name = "Vas Post Report";
                                var p_str_radio = var_name;
                                window.open('ShowReport?SelectedID=' + SelectedID + '&p_str_radio=' + p_str_radio + '&p_str_cmp_id=' + p_str_cmp_id + '&type=' + type, 'VasInquiry', "toolbar=no, scrollbars=yes, resizable=yes, top=200, left=500, width=950, height=700", 'ShowReport' + SelectedID)
                                debugger

                                $('#myModalVasEdit').modal('hide');
                                $.ajax({
                                    type: "get",
                                    url: "/VasInquiry/VasInquiryDtl",           
                                    data: {
                                        "p_str_cmp_id": p_str_cmp_id,
                                        "p_str_vas_id": p_str_vasid,
                                    },
                                    datatype: 'html',
                                    success: function (e) {
                                        debugger
                                        $("#ajaxloading").hide();
                                        $('#showgrid').html("");
                                        $('#showgrid').html(e);
                                    },
                                })

                                @*var url = '@Url.Action("OutboundInq", "OutboundInq")';

                                url += '?cmp=' + p_str_cmp_id;
                                url += '&screentitle=' + p_str_screen_title;
                                window.location.href = url;*@
                            });
                        });

                    }
                },

            })
        }
    });

    var cmp_id = $("#cmp_id").val();
    var VASDetailPostBackAddURL = '/BillingInquiry/LoadGenerateVASBillDetail';

    //$(".VasBillStatus").click(function () {
    $('#GridVasInqPartial tbody').on('click', '.VasBillStatus', function () {//CR2018-04-07-001 Added by Nithya
        debugger;
        var $buttonClicked = $(this);
        var p_str_cmpid = $('#cmp_id').val();
        var p_str_vasid = $buttonClicked.attr('data-id1');
        var p_str_vasdt = $buttonClicked.attr('data-id2');
        var p_str_screentitle = $('#screentitle').val();
        var options = { "backdrop": "static", keyboard: true };
        $("#ajaxLoading").show();
        var p_str_cmp_id = $('#cmp_id').val();
        var p_str_vas_id_fm = $('#vas_id_fm').val();
        var p_str_vas_id_to = $('#vas_id_to').val();
        var p_str_ship_vas_date_fm = $('#vas_date_fm').val();
        var p_str_vas_date_to = $('#vas_date_to').val();
        var p_str_so_num = $('#so_num').val();
        var p_str_Status = $('#Status').val();

        $.ajax({
            type: "GET",
            url: '@Url.Content("~/VasInquiry/VAS_ID_INQ_HDR_DATA")',
            data: {
                "p_str_cmp_id": p_str_cmp_id, "p_str_vas_id_fm": p_str_vas_id_fm, "p_str_vas_id_to": p_str_vas_id_to, "p_str_vas_date_fm": p_str_ship_vas_date_fm,
                "p_str_vas_date_to": p_str_vas_date_to, "p_str_so_num": p_str_so_num, "p_str_Status": p_str_Status, "p_str_Screen": p_str_screentitle

            },

            dataType: "json",
            success: function (e) {
                $("#ajaxLoading").hide();

            },
        });
        $.ajax({
            type: "GET",
            url: VASDetailPostBackAddURL,
            contentType: "application/json; charset=utf-8",
            data: { "p_str_cmpid": p_str_cmpid, "p_str_vasid": p_str_vasid, "p_str_vasdt": p_str_vasdt, "p_str_screentitle": p_str_screentitle },
            datatype: "json",
            success: function (data) {

                $('#myModalContentVasBill').html(data);
                $('#myModalVasBill').modal(options);
                $('#myModalVasBill').modal('show');
            },
            error: function () {
                alert("Dynamic content load failed.");
            }
        });
    });
    var cmp_id = $("#cmp_id").val();
    var VASBillDetailInq = '/BillingInquiry/GetSearchVASBillInqDtls';
    //$(".VasBillStatusInq").click(function () {
    $('#GridVasInqPartial tbody').on('click', '.VasBillStatusInq', function () {//CR2018-04-07-001 Added by Nithya
        debugger;
        var $buttonClicked = $(this);
        var p_str_cmpid = $('#cmp_id').val();
        var p_str_vasid = $buttonClicked.attr('data-id1');
        var p_str_vasdt = $buttonClicked.attr('data-id2');
        var p_str_screentitle = $('#screentitle').val();
        var p_str_cust_id = "";
        var p_str_print_dt = "";
        var p_str_vas_bill_pd_fm = $buttonClicked.attr('data-id3');;
        var p_str_vas_bill_pd_to = "";

        var options = { "backdrop": "static", keyboard: true };
        $("#ajaxLoading").show();
        var p_str_cmp_id = $('#cmp_id').val();
        var p_str_vas_id_fm = $('#vas_id_fm').val();
        var p_str_vas_id_to = $('#vas_id_to').val();
        var p_str_ship_vas_date_fm = $('#vas_date_fm').val();
        var p_str_vas_date_to = $('#vas_date_to').val();
        var p_str_so_num = $('#so_num').val();
        var p_str_Status = $('#Status').val();

        $.ajax({
            type: "GET",
            url: '@Url.Content("~/VasInquiry/VAS_ID_INQ_HDR_DATA")',
            data: {
                "p_str_cmp_id": p_str_cmp_id, "p_str_vas_id_fm": p_str_vas_id_fm, "p_str_vas_id_to": p_str_vas_id_to, "p_str_vas_date_fm": p_str_ship_vas_date_fm,
                "p_str_vas_date_to": p_str_vas_date_to, "p_str_so_num": p_str_so_num, "p_str_Status": p_str_Status, "p_str_Screen": p_str_screentitle

            },

            dataType: "json",
            success: function (e) {
                $("#ajaxLoading").hide();

            },
        });
        $.ajax({
            type: "GET",
            url: VASBillDetailInq,
            contentType: "application/json; charset=utf-8",
            data: { "p_str_cmpid": p_str_cmpid, "p_str_cust_id": p_str_cust_id, "p_str_print_dt": p_str_print_dt, "p_str_vas_bill_pd_fm": p_str_vas_bill_pd_fm, "p_str_vas_bill_pd_to": p_str_vas_bill_pd_to, "p_str_vas_id": p_str_vasid, "p_str_vas_dt": p_str_vasdt, "p_str_screentitle": p_str_screentitle },
            datatype: "json",
            success: function (data) {

                $('#myModalContentVasBill').html(data);
                $('#myModalVasBill').modal(options);
                $('#myModalVasBill').modal('show');
            },
            error: function () {
                alert("Dynamic content load failed.");
            }
        });
    });
</script>

<script type="text/javascript">
    $('#GridVasEntryEditDtl td[id="chkboxclick"]').click(function (event) {
        debugger
        var LINENUMBER = $(this).attr('id1');//CR-20180514-001 added by nithya
        var Minus = LINENUMBER - 1;
        var ImagesNewRowNumber = $("#Count_Values").val();
        var VasId = $("#vas_id").val();
        var _imagesCount = 0;
        for (var i = Minus; i < LINENUMBER; i++) {
            var p_str_check_value = $('#two').val();
            var qty = $("#qty_" + i).val();
            if (qty == 0 || qty == "") {//CR-20180514-001 added by nithya
                swal("", "Quantity And Amount Value > 0 ", "");
                return false;
            }
            if (qty == "") {
                qty = 0;
            }
            var price = $("#price_" + i).val();
            if (price == "") {
                price = 0;
            }

            //var sum_i = $("#qty_" + i).val() * $("#price_" + i).val();
            //    //alert(sum_i)
            //$("#amt_" + i).val(sum_i)
            //var newamount = $("#amt_" + i).val(sum_i);
            var Amount = $("#amt_" + i).val();
            var itmnum = $("#itmnum_" + i).val();
            var p_str_note = $("#Note_" + i).val();
            var p_str_RowNo = $(this).attr('id1');
            if (p_str_check_value == "true") {
                //if (qty == "" || qty == 0) {
                //    swal("", "Please Enter The Qty.", "");
                //    $("#qty_" + i).focus();
                //    $('body,html').animate({ scrollTop: 0 }, 0);
                //    er = 1;
                //    return false;
                //}
                //if (price == "") {
                //    swal("", "Please Enter The Price.", "");
                //    $("price_" + i).focus();
                //    $('body,html').animate({ scrollTop: 0 }, 0);
                //    er = 1;
                //    return false;
                //}
                //else
                $.ajax({
                    type: "POST",
                    url: '@Url.Content("~/VasInquiry/UpdRateTempDetails")',
                    data: {
                        "p_str_qty": qty,
                        "p_str_rate": price,
                        "p_str_amt": Amount,
                        "p_str_itmnum": itmnum,
                        "p_str_note": p_str_note,

                    },
                    dataType: 'html',
                    success: function (e) {
                    },

                })
                //}

            }
            else {
                $.ajax({
                    type: "POST",
                    url: '@Url.Content("~/VasInquiry/ReUpdateTempVasDetails")',
                    data: {
                        "p_str_qty": qty,
                        "p_str_rate": price,
                        "p_str_amt": Amount,
                        "p_str_itmnum": itmnum,
                        "p_str_note": p_str_note,
                        "p_str_RowNo": p_str_RowNo,
                        "VasId": VasId,

                    },
                    dataType: 'html',
                    success: function (e) {
                        debugger
                        $('#qty_' + i).val(0);
                        $('#amt_' + i).val(0.00);
                        $('#Note_' + i).val('');

                    },

                })
            }
        }

    });


    $("#btnVasEditCancel").click(function () {

        debugger
        var p_str_screentitle = $('#screentitle').val();
        var p_str_cmpid = $('#g_str_tmp_cmp_id').val();
        var p_str_screen_title = $('#screentitle').val();
        var p_str_ShipReq_id = $('#Sonum').val();
        sweetAlert({
            title: "",
            text: "Do you want to Close the Screen?",
            type: "",
            showCancelButton: true,
            confirmButtonClass: "btn-danger",
            confirmButtonText: "No",
            cancelButtonText: "Yes",
            closeOnConfirm: true,
            closeOnCancel: true
        },
                 function (isConfirm) {
                     if (isConfirm) {

                     }

                     else {
                         $('#myModalEdit').modal('hide');
                         if (p_str_screen_title == "OBVisibility" || p_str_screen_title == "OBInquiry")      //CR_3PL_MVC_VAS_2018_0324_001 Added by Soniya
                         {
                             @*var url = '@Url.Action("OutboundInq", "OutboundInq")';*@
                             $.ajax({
                                 type: "get",
                                 url: "/OutboundInq/GetOutboundInqDtl",
                                 data: {
                                     "p_str_cmp_id": p_str_cmpid,
                                     "p_str_so_num": p_str_ShipReq_id
                                 },
                                 datatype: 'html',
                                 success: function (e) {
                                     debugger
                                     $("#ajaxloading").hide();
                                     $('#showgrid').html("");
                                     $('#showgrid').html(e);
                                 },
                             })
                         }
                         else {

                             var url = '@Url.Action("VasInquiry", "VasInquiry")';
                         }
                         $("#ajaxloading").hide();

                     }
                 });
    })
</script>