@model  GsEPWv8_5_MVC.Model.EmailSetupModel

@{
    ViewBag.Title = "Report Email Setup";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
    int gintRecCount = Model.lstRptEmailDtl.Count;
    int intCurRow = 0;
    var lstrRptFileFormat = "";
}
<style>
    div#ajaxLoading {
        display: none;
        width: 100px;
        height: 100px;
        position: fixed;
        top: 30%;
        left: 56%;
        text-align: center;
        margin-left: -50px;
        margin-top: -100px;
        z-index: 2;
        overflow: auto;
    }
</style>
<style type="text/css">
    fieldset {
        border: 1px solid silver;
        padding: 8px;
        border-radius: 4px;
    }

    legend {
        padding: 2px;
    }

    legend {
        display: block;
        width: 100%;
        padding: 0;
        margin-bottom: 0px;
        font-size: 14px;
        line-height: inherit;
        color: #e81994;
        border: 0;
        font-weight: bold;
    }

    .fa {
        display: inline-block;
        font: normal normal normal 14px/1 FontAwesome;
        font-size: 12px;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
    }

    .ScreenTitle {
        padding-left: 40px;
        font-size: 18px;
        font-family: Verdana;
        font-weight: bold;
        padding-top: 13px;
    }

    .ui-autocomplete {
        color: black;
        font-family: verdana;
        font-size: 12px;
        font-weight: bold;
    }

    .text-muted {
        color: black;
    }

    .ui-widget-content {
        border: 1px solid #5dbebe;
        background: #e6e6e6;
        color: #333333;
    }
</style>
<link rel="stylesheet" href="~/plugins/datatables/dataTables.bootstrap.css">
<script src="~/Scripts/jquery-1.10.2.min.js"></script>
<link href="~/Scripts/Style/CommonStyleSheet.css" rel="stylesheet" />
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width" />
<link href="~/Scripts/ManualSheets/jquery-ui.css" rel="stylesheet" />
<link href="~/Scripts/AutoComplete/jquery-ui-1.10.4.custom.min.css" rel="stylesheet" />
<link href="~/Scripts/sweetalert.css" rel="stylesheet" />

@Html.HiddenFor(model => model.tmp_cmp_id, new { @id = "g_str_tmp_cmp_id" })
@Html.HiddenFor(model => model.screentitle)

@using (Html.BeginForm("EmailSetup", "EmailSetup", FormMethod.Post, new { @id = "form", @class = "col-xs-12", @enctype = "multipart/form-data" }))
{

    <div>
        <table style="width: 100%;">
            <tr>
                <td style="padding-top: 13px;width:10%;">
                    @if (System.Configuration.ConfigurationManager.AppSettings["CompanyWebLink"].ToString() == "3plpro.gensoftcorp.com")
                    {
                        <a href="/DashBoard/DashBoard" id="btnDashboard">
                            <b style="font-size:15px;text-decoration: underline;">Dashboard</b>
                            <i class="fa fa-arrow-circle-right"></i>
                        </a>
                    }
                    @if (System.Configuration.ConfigurationManager.AppSettings["CompanyWebLink"].ToString() == "3plecom.gensoftcorp.com")
                    {
                        <a href="/ECommDashBoard/ECommDashBoard" id="btnDashboard">
                            <b style="font-size:15px;text-decoration: underline;">Dashboard</b>
                            <i class="fa fa-arrow-circle-right"></i>
                        </a>
                    }
                </td>
                <td style="width: 60%" class="ScreenTitle">
                    Reports Email Setup
                </td>

                <td style="padding-top: 11px;width:30%;text-align:right">
                    @if (System.Configuration.ConfigurationManager.AppSettings["CompanyWebLink"].ToString() == "3plpro.gensoftcorp.com")
                    {
                        <button type="button" id="btnClose" class="btn-Close">Close</button>
                    }
                    @if (System.Configuration.ConfigurationManager.AppSettings["CompanyWebLink"].ToString() == "3plecom.gensoftcorp.com")
                    {
                        <button type="button" id="btnCloseecom" class="btn-Close">Close</button>
                    }
                </td>
            </tr>
        </table>
    </div>
    <div id="ajaxLoading" style="display:none;">
        <img src="~/Images/ajax-loader.gif" />
    </div>

    <div class="box box-default" style="box-shadow: 0 1px 1px white;">
        <div class="box-header with-border" style="background-color:#1357d0; padding:5px; ">
            <h6 class="box-title" style="color:white;font-size:16px; font-weight: bolder;">Filter Details</h6>
            <div class="box-tools">
                <input type="button" class="btn btn-box-tool" style="color:white;font-size:11px; font-weight:bold;" value="(Click to hide...)" onclick="return change(this);" data-widget="collapse" title="(Click to hide...)" />
            </div>
        </div>
        <div>
            <br />
            <table style="width:100%;padding-top:5px;">
                <tr>
                    <td style="text-align: right;width:5%">
                        <label><b class="Lblmanual">Company</b></label>
                    </td>
                    <td style="width:50%; padding-left: 1%;">
                        @Html.DropDownListFor(model => model.cmp_id, new SelectList(Model.ListCompanyPickDtl, "cmp_id", "cmp_name"), "---Select All---", new { @class = "form-control txtlbl" })
                    </td>
                    <td style="text-align: right;width:10%">
                        <button type="button" id="btnSearch" class="btn_search" style="margin-left: 1%;">Search</button>
                    </td>
                    <td style="text-align: right;width:10%">
                        <button type="button" id="btnSaveEmailSetup" class="btn_NewEntry" style="margin-left: 1%;">Save</button>
                    </td>

                    <td style="text-align: right;width:25%">
                        <button type="button" id="btnCopyHdrToAll" class="btn_search" style="margin-left: 1%; width: 200px;">Copy Header Email to All </button>
                    </td>

                    <td></td>
                </tr>
                <tr>

                    <td></td>
                </tr>

            </table>

            <br />
        </div>

</div>
                        <div id="divDetial">
                            <div id="RptEmailChildTabs">
                                <ul>
                                    <li><a href="#childtabs-0" style="font-size:12px;">General Email Setup</a></li>
                                    <li><a href="#childtabs-1" style="font-size:12px;">INBOUND Report</a></li>
                                    <li><a href="#childtabs-2" style="font-size:12px;">OUTBOUND and VAS Report</a></li>
                                    <li><a href="#childtabs-3" style="font-size:12px;">INVENTORY and Billing Report</a></li>

                                </ul>
                                <div id="childtabs-0">
                                    <div class="box-header">
                                        <div class="box-body">
                                            <fieldset>
                                                <legend style="text-align:left;">General Report Email Setup </legend>
                                                <table>
                                                    <tr>
                                                        <td style="width:5%; text-align:right;">
                                                            <b style="font-size: 14px;">Email From</b>
                                                        </td>
                                                        <td style="width:13%;padding-bottom: 12px;padding-left: 10px;padding-top: 14px;">
                                                            <table>
                                                                <tr>
                                                                    <td>
                                                                        @Html.TextBoxFor(model => model.objEmailCommon.emailFrom, new {  @id = "emlemailFrom", @class = "form-control", @maxlength = "100", @style = "width:400px; height:32px; Font-weight:bold;" })
                                                                    </td>

                                                                </tr>
                                                            </table>
                                                        </td>
                                                    </tr>

                                                    <tr>
                                                        <td style="width:5%; text-align:right;">
                                                            <b style="font-size: 14px;">Company Email To:(, Seperated)</b>
                                                        </td>
                                                        <td style="width:13%;padding-bottom: 12px;padding-left: 10px;padding-top: 14px;">
                                                            <table>
                                                                <tr>
                                                                    <td>
                                                                        @Html.TextBoxFor(model => model.objEmailCommon.cmpEmailTo, new { @type = "email", @id = "emlCmpEmailTo", @class = "form-control", placeholder = "Ex. abc@domain.com,abc@domain.com ", @maxlength = "500", @style = "width:952px; height:35px; Font-weight:bold;" })
                                                                    </td>
                                                                    <td>
                                                                        <button type="button" id="btnCmpEmailTo" class="btn-Close" style="background-color: #ffac00;width:90px">Cmp Email</button>
                                                                    </td>
                                                                </tr>
                                                            </table>

                                                        </td>

                                                    </tr>
                                                    <tr>
                                                        <td style="width:5%; text-align:right;">
                                                            <b style="font-size: 14px;">Customer Email To:(, Seperated)</b>
                                                        </td>
                                                        <td style="padding-bottom: 10px;padding-left: 10px;">
                                                            <table>
                                                                <tr>
                                                                    <td>
                                                                        @Html.TextBoxFor(model => model.objEmailCommon.custEmailTo, new { @id = "emlCustEmailTo", @class = "form-control", placeholder = "Ex. abc@domain.com,abc@domain.com ", required = "required", @maxlength = "500", @style = "width: 956px; height:35px; Font-weight:bold;" })
                                                                    </td>
                                                                    <td>
                                                                        <button type="button" id="btnCustEmailTo" class="btn-Close" style="background-color: #ffac00;width:90px">Cust Email</button>
                                                                    </td>
                                                            </table>

                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="width:5%; text-align:right;">
                                                            <b style="font-size: 14px;">Email CC:(, Seperated)</b>
                                                        </td>
                                                        <td style="width:13%;padding-bottom: 12px;padding-left: 10px;padding-top: 14px;">
                                                            <table>
                                                                <tr>
                                                                    <td>
                                                                        @Html.TextBoxFor(model => model.objEmailCommon.emailCC, new { @type = "email", @id = "emlEmailCC", @class = "form-control", placeholder = "Ex. abc@domain.com,abc@domain.com", @maxlength = "200", @style = "width:952px; height:32px; Font-weight:bold;" })
                                                                    </td>

                                                                </tr>
                                                            </table>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="width:5%; text-align:right;">
                                                            <b style="font-size: 14px;"> Message:</b>
                                                        </td>
                                                        <td style="padding-bottom: 10px;padding-left: 10px;text-align:right">
                                                            @Html.TextAreaFor(model => model.objEmailCommon.emailMessage, new { @id = "emlEmailMessage", @class = "form-control",  required = "required", @maxlength = "1000", @style = "height:150px; Font-weight:bold;" })
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style="width:5%; text-align:right;">
                                                            <b style="font-size: 14px;"> Email Footer:</b>
                                                        </td>
                                                        <td style="padding-bottom: 10px;padding-left: 10px;text-align:right">
                                                            @Html.TextAreaFor(model => model.objEmailCommon.emailFooter, new { @id = "emlEmailFooter", @class = "form-control",  required = "required", @maxlength = "1000", @style = "height:150px; Font-weight:bold;" })
                                                        </td>
                                                    </tr>

                                                </table>
                                            </fieldset>
                                        </div>
                                    </div>
                                    </div>
                                    <div id="childtabs-1">
                                        <div class="box-body">
                                            <div class="box-header">
                                                <div class="row">
                                                    <div class="col-md-12 col-sm-12 col-xs-12">
                                                        <div class="col-md-7 col-sm-7 col-xs-7">
                                                            <table style="width:100%;padding-top:5px;border-collapse:separate;border-spacing: 0px 0.5em;"></table>
                                                        </div>
                                                        <div class="col-md-2 col-sm-2 col-xs-2"></div>
                                                        <div class="col-md-3 col-sm-3 col-xs-3">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div id="grdEmailSetup" class="box-header" style="padding: 5px; ">
                                                <hr class="break" />
                                                <div class="box-body">
                                                    <div>
                                                        <table id="tblEmailIB" class="table table-bordered table-striped">
                                                            <thead class="grid_backcolor">
                                                                <tr>
                                                                    <th class="grid_header_backcolor" style="width:3%;">Save</th>
                                                                    <th class="grid_header_backcolor" style="display:none">Module</th>
                                                                    <th class="grid_header_backcolor" style="display:none">Report Id</th>
                                                                    <th class="grid_header_backcolor" style="width:15%;">Report Name</th>
                                                                    <th class="grid_header_backcolor" style="width:6%;">Format</th>
                                                                    <th class="grid_header_backcolor" style="width:17%;">Cmp. Email List</th>
                                                                    <th class="grid_header_backcolor" style="width:3%;">Sel</th>
                                                                    <th class="grid_header_backcolor" style="width:20%;">Cust. Email List</th>
                                                                    <th class="grid_header_backcolor" style="width:3%;">Sel</th>
                                                                    <th class="grid_header_backcolor" style="width:30%;">Email Body</th>
                                                                    <th class="grid_header_backcolor" style="width:5%;">AutoEmail</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody style="width:100%;">

                                                                @for (int i = 0; i < Model.lstRptEmailDtl.Count; i++)
                                                            {
                                                                lstrRptFileFormat = Model.lstRptEmailDtl[i].rpt_file_format;
                                                                if ((@Model.lstRptEmailDtl[i].module_name == "INBOUND") || (@Model.lstRptEmailDtl[i].module_name == "MASTER"))
                                                                {
                                                            <tr id="grdRow_@intCurRow" class="row-select" style="width:100%;">
                                                                <td style="text-align:center">
                                                                    <input class="checkbox" id="chkRec_@intCurRow" name="tblcheckboxRptId" type="checkbox" value="@Model.lstRptEmailDtl[i].rpt_id" />
                                                                </td>
                                                                <td style="color:black;display:none; font-size:12px">
                                                                    @Html.TextBoxFor(model => @Model.lstRptEmailDtl[i].module_name, new { @class = "form-control txtlbl", @disabled = "true", @maxlength = "20", @id = "eml_module_name_" + intCurRow, @style = "background-color:white;" })
                                                                </td>
                                                                <td style="color:black;display:none; font-size:12px">
                                                                    @Html.TextBoxFor(model => @Model.lstRptEmailDtl[i].rpt_id, new { @class = "form-control txtlbl", @disabled = "true", @maxlength = "20", @id = "eml_rpt_id_" + intCurRow, @style = "background-color:white;" })
                                                                </td>
                                                                <td style="color:black; font-size:12px">

                                                                    @Html.TextBoxFor(model => @Model.lstRptEmailDtl[i].rpt_name, new { @class = "form-control txtlbl", @disabled = "true", @maxlength = "100", @id = "eml_rpt_name_" + intCurRow, @style = "background-color:lightyellow;" })
                                                                </td>

                                                                <td style="color:black; font-size:12px">
                                                                    @Html.DropDownListFor(model => model.lstRptEmailDtl[i].rpt_file_format, new SelectList(Model.ListRptEmailFormat, "name", "description", lstrRptFileFormat), new { @id = "eml_rpt_file_format_" + intCurRow, @class = "form-control txtlbl", @maxlength = "20", @style = "font-size: 12px; font-family: verdana; width: 100px;background-color:lightyellow;" })
                                                                </td>
                                                                <td style="color:black; font-size:12px">
                                                                    @Html.TextBoxFor(model => @Model.lstRptEmailDtl[i].cmp_email_list, new { @class = "form-control txtlbl", @maxlength = "500", @id = "eml_cmp_email_list_" + intCurRow, @style = "background-color:lightyellow;" })
                                                                </td>
                                                                <td style="color:black; font-size:12px">
                                                                    <a href="javascript:void(0);" class="btn btn-primary small btncmpEmail" style="color: white;height: 25px;width: 20px; border-radius: 5px;font-size: 12px;font-family: bold;padding-top: 5px; background-color:#ff9966" dataCurRow="@intCurRow" dataCmpEmail="@Model.lstRptEmailDtl[i].rpt_id">E</a>
                                                                </td>

                                                                <td style="color:black; font-size:12px">
                                                                    @Html.TextBoxFor(model => @Model.lstRptEmailDtl[i].cust_email_list, new { @class = "form-control txtlbl", @maxlength = "500", @id = "eml_cust_email_list_" + intCurRow, @style = "background-color:lightyellow;" })
                                                                </td>
                                                                <td style="color:black; font-size:12px">
                                                                    <a href="javascript:void(0);" class="btn btn-primary small btnCustEmail" style="color: white;height: 25px;width: 20px; border-radius: 5px;font-size: 12px;font-family: bold;padding-top: 5px; background-color:#ff9966" dataCurRow="@intCurRow" dataCustEmail="@Model.lstRptEmailDtl[i].rpt_id">E</a>
                                                                </td>
                                                                <td style="color:black; font-size:12px">
                                                                    @Html.TextBoxFor(model => @Model.lstRptEmailDtl[i].email_body, new { @class = "form-control txtlbl", @maxlength = "1000", @id = "eml_email_body_" + intCurRow, @style = "background-color:lightyellow;" })
                                                                </td>
                                                                @if (@Model.lstRptEmailDtl[i].is_auto_email == "Y")
                                                                        {
                                                                        <td style="text-align:center">
                                                                            <input class="checkbox" id="chkboxAutoEmail_@intCurRow" name="tblcheckboxAutoEmail" type="checkbox" checked />
                                                                        </td>
                                                                        }
                                                                        else
                                                                        {
                                                                        <td style="text-align:center">
                                                                            <input class="checkbox" id="chkboxAutoEmail_@intCurRow" name="tblcheckboxAutoEmail" type="checkbox" />
                                                                        </td>
                                                                        }

                                                            </tr>
                                                                    intCurRow = intCurRow + 1;
                                                                }
                                                            }
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="childtabs-2">
                                        <div id="showgrid" class="box-header" style="padding: 5px; ">
                                            <hr class="break" />
                                            <div class="box-body">
                                                <div>
                                                    <table id="tblEmailIB" class="table table-bordered table-striped">
                                                        <thead class="grid_backcolor">
                                                            <tr>
                                                                <th class="grid_header_backcolor" style="width:3%;">Sel</th>
                                                                <th class="grid_header_backcolor" style="display:none">Module</th>
                                                                <th class="grid_header_backcolor" style="display:none">Report Id</th>
                                                                <th class="grid_header_backcolor" style="width:15%;">Report Name</th>
                                                                <th class="grid_header_backcolor" style="width:6%;">Format</th>
                                                                <th class="grid_header_backcolor" style="width:17%;">Cmp. Email List</th>
                                                                <th class="grid_header_backcolor" style="width:3%;">Sel</th>
                                                                <th class="grid_header_backcolor" style="width:20%;">Cust. Email List</th>
                                                                <th class="grid_header_backcolor" style="width:3%;">Sel</th>
                                                                <th class="grid_header_backcolor" style="width:30%;">Email Body</th>
                                                                <th class="grid_header_backcolor" style="width:5%;">AutoEmail</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody style="width:100%;">

                                                            @for (int i = 0; i < Model.lstRptEmailDtl.Count; i++)
                                                            {
                                                                lstrRptFileFormat = Model.lstRptEmailDtl[i].rpt_file_format;
                                                                if ((@Model.lstRptEmailDtl[i].module_name == "OUTBOUND") || (@Model.lstRptEmailDtl[i].module_name == "VAS"))
                                                                {
                                                                    <tr id="grdRow_@intCurRow" class="row-select" style="width:100%;">
                                                                        <td style="text-align:center">
                                                                            <input class="checkbox" id="chkRec_@intCurRow" name="tblcheckboxRptId" type="checkbox" value="@Model.lstRptEmailDtl[i].rpt_id" />
                                                                        </td>
                                                                        <td style="color:black;display:none; font-size:12px">
                                                                            @Html.TextBoxFor(model => @Model.lstRptEmailDtl[i].module_name, new { @class = "form-control txtlbl", @disabled = "true", @maxlength = "20", @id = "eml_module_name_" + intCurRow, @style = "background-color:white;" })
                                                                        </td>
                                                                        <td style="color:black;display:none; font-size:12px">
                                                                            @Html.TextBoxFor(model => @Model.lstRptEmailDtl[i].rpt_id, new { @class = "form-control txtlbl", @disabled = "true", @maxlength = "20", @id = "eml_rpt_id_" + intCurRow, @style = "background-color:white;" })
                                                                        </td>
                                                                        <td style="color:black; font-size:12px">
                                                                            @Html.TextBoxFor(model => @Model.lstRptEmailDtl[i].rpt_name, new { @class = "form-control txtlbl", @disabled = "true", @maxlength = "100", @id = "eml_rpt_name_" + intCurRow, @style = "background-color:lightyellow;" })
                                                                        </td>

                                                                        <td style="color:black; font-size:12px">
                                                                            @Html.DropDownListFor(model => model.lstRptEmailDtl[i].rpt_file_format, new SelectList(Model.ListRptEmailFormat, "name", "description", lstrRptFileFormat), new { @id = "eml_rpt_file_format_" + intCurRow, @class = "form-control txtlbl", @maxlength = "20", @style = "font-size: 12px; font-family: verdana; width: 100px;background-color:lightyellow;" })
                                                                        </td>
                                                                        <td style="color:black; font-size:12px">
                                                                            @Html.TextBoxFor(model => @Model.lstRptEmailDtl[i].cmp_email_list, new { @class = "form-control txtlbl", @maxlength = "500", @id = "eml_cmp_email_list_" + intCurRow, @style = "background-color:lightyellow;" })
                                                                        </td>
                                                                        <td style="color:black; font-size:12px">
                                                                            <a href="javascript:void(0);" class="btn btn-primary small btncmpEmail" style="color: white;height: 25px;width: 20px; border-radius: 5px;font-size: 12px;font-family: bold;padding-top: 5px; background-color:#ff9966" dataCurRow="@intCurRow" dataCmpEmail="@Model.lstRptEmailDtl[i].rpt_id">E</a>
                                                                        </td>
                                                                        <td style="color:black; font-size:12px">
                                                                            @Html.TextBoxFor(model => @Model.lstRptEmailDtl[i].cust_email_list, new { @class = "form-control txtlbl", @maxlength = "500", @id = "eml_cust_email_list_" + intCurRow, @style = "background-color:lightyellow;" })
                                                                        </td>
                                                                        <td style="color:black; font-size:12px">
                                                                            <a href="javascript:void(0);" class="btn btn-primary small btnCustEmail" style="color: white;height: 25px;width: 20px; border-radius: 5px;font-size: 12px;font-family: bold;padding-top: 5px; background-color:#ff9966" dataCurRow="@intCurRow" dataCustEmail="@Model.lstRptEmailDtl[i].rpt_id">E</a>
                                                                        </td>
                                                                        <td style="color:black; font-size:12px">
                                                                            @Html.TextBoxFor(model => @Model.lstRptEmailDtl[i].email_body, new { @class = "form-control txtlbl", @maxlength = "1000", @id = "eml_email_body_" + intCurRow, @style = "background-color:lightyellow;" })
                                                                        </td>
                                                                        @if (@Model.lstRptEmailDtl[i].is_auto_email == "Y")
                                                                        {
                                                                            <td style="text-align:center">
                                                                                <input class="checkbox" id="chkboxAutoEmail_@intCurRow" name="tblcheckboxAutoEmail" type="checkbox" checked />
                                                                            </td>
                                                                        }
                                                                        else
                                                                        {
                                                                            <td style="text-align:center">
                                                                                <input class="checkbox" id="chkboxAutoEmail_@intCurRow" name="tblcheckboxAutoEmail" type="checkbox" />
                                                                            </td>
                                                                        }


                                                                    </tr>
                                                                    intCurRow = intCurRow + 1;
                                                                }

                                                            }
                                                        </tbody>

                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="childtabs-3">
                                        <div id="IVshowgrid" class="box-header" style="padding: 5px; ">
                                            <hr class="break" />
                                            <div class="box-body">
                                                <div>
                                                    <table id="tblEmailIB" class="table table-bordered table-striped">
                                                        <thead class="grid_backcolor">
                                                            <tr>
                                                                <th class="grid_header_backcolor" style="width:3%;">Sel</th>
                                                                <th class="grid_header_backcolor" style="display:none">Module</th>
                                                                <th class="grid_header_backcolor" style="display:none">Report Id</th>
                                                                <th class="grid_header_backcolor" style="width:15%;">Report Name</th>
                                                                <th class="grid_header_backcolor" style="width:6%;">Format</th>
                                                                <th class="grid_header_backcolor" style="width:17%;">Cmp. Email List</th>
                                                                <th class="grid_header_backcolor" style="width:3%;">Sel</th>
                                                                <th class="grid_header_backcolor" style="width:20%;">Cust. Email List</th>
                                                                <th class="grid_header_backcolor" style="width:3%;">Sel</th>
                                                                <th class="grid_header_backcolor" style="width:30%;">Email Body</th>
                                                                <th class="grid_header_backcolor" style="width:5%;">AutoEmail</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody style="width:100%;">
                                                            @for (int i = 0; i < Model.lstRptEmailDtl.Count; i++)
                                                            {
                                                                lstrRptFileFormat = Model.lstRptEmailDtl[i].rpt_file_format;
                                                                if ((@Model.lstRptEmailDtl[i].module_name == "BILL") || (@Model.lstRptEmailDtl[i].module_name == "INV"))
                                                                {
                                                                    <tr id="grdRow_@intCurRow" class="row-select" style="width:100%;">
                                                                        <td style="text-align:center">
                                                                            <input class="checkbox" id="chkRec_@intCurRow" name="tblcheckboxRptId" type="checkbox" value="@Model.lstRptEmailDtl[i].rpt_id" />
                                                                        </td>
                                                                        <td style="color:black;display:none; font-size:12px">
                                                                            @Html.TextBoxFor(model => @Model.lstRptEmailDtl[i].module_name, new { @class = "form-control txtlbl", @disabled = "true", @maxlength = "20", @id = "eml_module_name_" + intCurRow, @style = "background-color:white;" })
                                                                        </td>
                                                                        <td style="color:black;display:none; font-size:12px">
                                                                            @Html.TextBoxFor(model => @Model.lstRptEmailDtl[i].rpt_id, new { @class = "form-control txtlbl", @disabled = "true", @maxlength = "20", @id = "eml_rpt_id_" + intCurRow, @style = "background-color:white;" })
                                                                        </td>
                                                                        <td style="color:black; font-size:12px">
                                                                            @Html.TextBoxFor(model => @Model.lstRptEmailDtl[i].rpt_name, new { @class = "form-control txtlbl", @disabled = "true", @maxlength = "100", @id = "eml_rpt_name_" + intCurRow, @style = "background-color:lightyellow;" })
                                                                        </td>

                                                                        <td style="color:black; font-size:12px">
                                                                            @Html.DropDownListFor(model => model.lstRptEmailDtl[i].rpt_file_format, new SelectList(Model.ListRptEmailFormat, "name", "description", lstrRptFileFormat), new { @id = "eml_rpt_file_format_" + intCurRow, @class = "form-control txtlbl", @maxlength = "20", @style = "font-size: 12px; font-family: verdana; width: 100px;background-color:lightyellow;" })
                                                                        </td>
                                                                        <td style="color:black; font-size:12px">
                                                                            @Html.TextBoxFor(model => @Model.lstRptEmailDtl[i].cmp_email_list, new { @class = "form-control txtlbl", @maxlength = "500", @id = "eml_cmp_email_list_" + intCurRow, @style = "background-color:lightyellow;" })
                                                                        </td>
                                                                        <td style="color:black; font-size:12px">
                                                                            <a href="javascript:void(0);" class="btn btn-primary small btncmpEmail" style="color: white;height: 25px;width: 20px; border-radius: 5px;font-size: 12px;font-family: bold;padding-top: 5px; background-color:#ff9966" dataCurRow="@intCurRow" dataCmpEmail="@Model.lstRptEmailDtl[i].rpt_id">E</a>
                                                                        </td>
                                                                        <td style="color:black; font-size:12px">
                                                                            @Html.TextBoxFor(model => @Model.lstRptEmailDtl[i].cust_email_list, new { @class = "form-control txtlbl", @maxlength = "500", @id = "eml_cust_email_list_" + intCurRow, @style = "background-color:lightyellow;" })
                                                                        </td>
                                                                        <td style="color:black; font-size:12px">
                                                                            <a href="javascript:void(0);" class="btn btn-primary small btnCustEmail" style="color: white;height: 25px;width: 20px; border-radius: 5px;font-size: 12px;font-family: bold;padding-top: 5px; background-color:#ff9966" dataCurRow="@intCurRow" dataCustEmail="@Model.lstRptEmailDtl[i].rpt_id">E</a>
                                                                        </td>
                                                                        <td style="color:black; font-size:12px">
                                                                            @Html.TextBoxFor(model => @Model.lstRptEmailDtl[i].email_body, new { @class = "form-control txtlbl", @maxlength = "1000", @id = "eml_email_body_" + intCurRow, @style = "background-color:lightyellow;" })
                                                                        </td>
                                                                        @if (@Model.lstRptEmailDtl[i].is_auto_email == "Y")
                                                                        {
                                                                            <td style="text-align:center">
                                                                                <input class="checkbox" id="chkboxAutoEmail_@intCurRow" name="tblcheckboxAutoEmail" type="checkbox" checked />
                                                                            </td>
                                                                        }
                                                                        else
                                                                        {
                                                                            <td style="text-align:center">
                                                                                <input class="checkbox" id="chkboxAutoEmail_@intCurRow" name="tblcheckboxAutoEmail" type="checkbox" />
                                                                            </td>
                                                                        }

                                                                    </tr>
                                                                    intCurRow = intCurRow + 1;
                                                                }
                                                            }

                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    @Html.Hidden("hdnRecCount", gintRecCount)

                                </div>
                        </div>
                        <div id="divDetialNew"></div>
                        <div id='myModalEmail' class='modal'>
                            <div class="modal-dialog">
                                <div class="modal-content" style="width: 198%; left:-160px;">
                                    <div id='myModalEmailContent' style="width: 100%; height: 605px;"></div>
                                </div>
                            </div>

                        </div>

                        <div id='UsersEmail' class='modal' style="padding-left:947px;padding-top:271px">
                            <div class="modal-dialog">
                                <div class="modal-content" style="width: 100%;">
                                    <div id='UsersEmailContent' style="width: 100%; height: 360px;"></div>
                                </div>
                            </div>
                        </div>
                        }



                        <script src="~/plugins/datatables/jquery.dataTables.min.js"></script>
                        <script src="~/plugins/datatables/dataTables.bootstrap.min.js"></script>
                        <script src="~/Scripts/AutoComplete/jquery-ui-1.10.4.custom.min.js"></script>
                        <script src="~/Scripts/sweetalert.js"></script>


                        <script type="text/javascript">
                            $(function () {
                                $('#tblEmailIB tbody').on('click', '.btncmpEmail', function () {
                                    debugger
                                    var $buttonClicked = $(this);
                                    var lintCurRow = $buttonClicked.attr('dataCurRow');
                                    var lintCurLine = parseFloat(lintCurRow);
                                    var lstrCmpEmailList = $("#eml_cmp_email_list_" + lintCurLine).val();
                                    var p_str_form_control = "eml_cmp_email_list_" + lintCurLine;
                                    var options = { "backdrop": "static", keyboard: true };
                                    var p_str_cmp_id = $("#cmp_id").val();
                                    var p_str_cmp_email_to = lstrCmpEmailList;
                                    var pstrEmailType = 'CMP';
                                    $("#ajaxLoading").show();
                                    $.ajax({
                                        url: '@Url.Action("GetEmailList", "EmailSetup")',
                                        contentType: "application/json; charset=utf-8",
                                        type: 'GET',
                                        data: { "pstrCmpId": p_str_cmp_id, "pstrEmail": p_str_cmp_email_to, "pstrFormControl": p_str_form_control, "pstrEmailType": pstrEmailType },
                                        datatype: "json",
                                        success: function (data) {
                                            $('#UsersEmailContent').html(data);
                                            $('#UsersEmail').modal(options);
                                            $('#UsersEmail').modal('show');
                                            $("#ajaxLoading").hide();
                                        }
                                    });

                                });
                            });

                            
                            $(function () {
                                $('#tblEmailIB tbody').on('click', '.btnCustEmail', function () {
                                    debugger
                                    var $buttonClicked = $(this);
                                    var lintCurRow = $buttonClicked.attr('dataCurRow');
                                    var lintCurLine = parseFloat(lintCurRow);
                                    var lstrCustEmailList = $("#eml_cust_email_list_" + lintCurLine).val();
                                    var p_str_form_control = "eml_cust_email_list_" + lintCurLine;
                                    var options = { "backdrop": "static", keyboard: true };
                                    var p_str_cmp_id = $("#cmp_id").val();
                                    var p_str_cust_email_to = lstrCustEmailList;
                                    var pstrEmailType = 'CUST';
                                    $("#ajaxLoading").show();
                                    $.ajax({
                                        url: '@Url.Action("GetEmailList", "EmailSetup")',
                                        contentType: "application/json; charset=utf-8",
                                        type: 'GET',
                                        data: { "pstrCmpId": p_str_cmp_id, "pstrEmail": p_str_cust_email_to, "pstrFormControl": p_str_form_control, "pstrEmailType": pstrEmailType },
                                        datatype: "json",
                                        success: function (data) {
                                            $('#UsersEmailContent').html(data);
                                            $('#UsersEmail').modal(options);
                                            $('#UsersEmail').modal('show');
                                            $("#ajaxLoading").hide();
                                        }
                                    });

                                });
                            });


                            $(function () {
                                $("#RptEmailChildTabs").tabs();
                            });

                            $("#btnCopyHdrToAll").click(function () {
                                debugger;
                                var lintRecCount = $("#hdnRecCount").val();
                                for (var i = 0; i < lintRecCount; i++)
                                {
                                    var cmp_email_list = $("#eml_cmp_email_list_" + i).val();
                                    var cust_email_list = $("#eml_cust_email_list_" + i).val();
                                     if ((cmp_email_list == '') && (cust_email_list == '') )
                                     {
                                         $("#chkRec_" + i).prop('checked', true);

                                        $("#eml_cmp_email_list_" + i).val($('#emlCmpEmailTo').val());
                                        $("#eml_cust_email_list_" + i).val($('#emlCustEmailTo').val());
                                    }

                                }
                            });

                            $("#btnSaveEmailSetup").click(function () {
                                debugger;
                                lstrCmpId = $('#cmp_id').val();
                                var l_int_sel_count = $("input[name='tblcheckboxRptId']:checked").length;
                                if (l_int_sel_count > 0) {
                                    var lintRecCount = $("#hdnRecCount").val();
                                }
                                if (lintRecCount == 0) {
                                    swal("", "No Records selected to save", "");
                                    return false;
                                }
                                var objEmailCommon = {};
                                objEmailCommon.cmpId = $('#cmp_id').val();
                                objEmailCommon.emailFrom = $('#emlemailFrom').val();
                                objEmailCommon.cmpEmailTo = $('#emlCmpEmailTo').val();
                                objEmailCommon.custEmailTo = $('#emlCustEmailTo').val();
                                objEmailCommon.emailCC = $('#emlEmailCC').val();
                                objEmailCommon.emailMessage = $('#emlEmailMessage').val();
                                objEmailCommon.emailFooter = $('#emlEmailFooter').val();

                                var lstRptEmailDt = new Array();
                                for (var i = 0; i < lintRecCount; i++) {
                                    var l_str_is_selected = false;
                                    var l_chkbox = "chkRec_" + i;
                                    var element = document.getElementById(l_chkbox);

                                    if (typeof (element) != 'undefined' && element != null) {
                                        var l_str_is_selected = document.getElementById(l_chkbox).checked;
                                    }
                                    else {
                                        l_str_is_selected = false;
                                    }

                                    if (l_str_is_selected) {
                                        var objEmailSetup = {};
                                        objEmailSetup.cmp_id = $('#cmp_id').val();
                                        objEmailSetup.module_name = $("#eml_module_name_" + i).val();
                                        objEmailSetup.rpt_id = $("#eml_rpt_id_" + i).val();
                                        objEmailSetup.rpt_file_format = $("#eml_rpt_file_format_" + i).val();
                                        objEmailSetup.cmp_email_list = $("#eml_cmp_email_list_" + i).val();
                                        objEmailSetup.cust_email_list = $("#eml_cust_email_list_" + i).val();
                                        objEmailSetup.email_body = $("#eml_email_body_" + i).val();
                                        var lchkboxAutoEmail = "chkboxAutoEmail_" + i;
                                        var elementAutoEmail = document.getElementById(lchkboxAutoEmail);
                                        if (typeof (elementAutoEmail) != 'undefined' && elementAutoEmail != null) {
                                            var lblnAutoEmail = document.getElementById(lchkboxAutoEmail).checked;
                                        }
                                        else {
                                            lblnAutoEmail = false;
                                        }
                                        if (lblnAutoEmail) {
                                            objEmailSetup.is_auto_email = 'Y';
                                        }
                                        else {
                                            objEmailSetup.is_auto_email = 'N';
                                        }
                                        lstRptEmailDt.push(objEmailSetup);

                                    }
                                }

                                $("#ajaxLoading").show();

                                $.ajax({
                                    type: "POST",
                                    url: '@Url.Content("~/EmailSetup/SaveReportEmailSetup")',
                                    data: JSON.stringify({
                                        "pstrCmpId": lstrCmpId,
                                        lstRptEmailDt: lstRptEmailDt,
                                        "objEmailCommon": objEmailCommon
                                    }),
                                    contentType: "application/json; charset=utf-8",
                                    dataType: "json",

                                    success: function (e) {
                                        $("#ajaxLoading").hide();
                                        swal({
                                            title: "",
                                            text: "Email setup Saved Successfully",
                                            type: "",
                                            showCancelButton: false,
                                            confirmButtonClass: "btn-danger",
                                            confirmButtonText: "Ok",
                                            closeOnConfirm: true
                                        },

                                        function () {
                                            debugger;
                                            setTimeout(function () {

                                            });
                                        });
                                    }
                                });

                            });

                            $("#btnSearch").click(function () {
                                debugger;
                                var pstrCmpId = $("#cmp_id").val();
                                $("#ajaxLoading").show();
                                $.ajax({
                                    type: "GET",
                                    url: '@Url.Content("~/EmailSetup/getEmailSetup")',
                                    data: {
                                        "pstrCmpId": pstrCmpId
                                    },
                                    dataType: 'html',
                                    success: function (e) {
                                        $("#ajaxLoading").hide();
                                        $('#divDetial').html("");
                                        $('#divDetial').hide();
                                        $('#divDetialNew').html("");
                                        $('#divDetialNew').html(e);
                                    },

                                })
                            });

                        </script>
                        <script type="text/javascript">
                            $("#btnClose").click(function () {
                                debugger
                                var p_str_cmpid = $('#g_str_tmp_cmp_id').val();
                                var url = '@Url.Action("Dashboard", "Dashboard")';
                                url += '?id=' + p_str_cmpid;
                                window.location.href = url;
                            })

                            $("#btnCloseecom").click(function () {
                                debugger
                                var p_str_cmpid = $('#g_str_tmp_cmp_id').val();
                                var url = '@Url.Action("ECommDashBoard", "ECommDashBoard")';
                                url += '?id=' + p_str_cmpid;
                                window.location.href = url;
                            })

                            $("#btnDashboard").click(function () {
                                var p_str_cmpid = $('#g_str_tmp_cmp_id').val();
                                var url = '@Url.Action("Dashboard", "Dashboard")';
                                url += '?id=' + p_str_cmpid;
                                window.location.href = url;
                            })

                            $(function () {

                                $('#cmp_id').change(function () {
                                    debugger;
                                    var l_str_comp = this.value;
                                    debugger
                                    $("#p_str_company").val(l_str_comp);
                                    var p_str_cmp_id = $(this).find(":selected").val();
                                    $.ajax({
                                        url: '@Url.Action("CmpIdOnChange", "EmailSetup")',
                                        type: 'GET',
                                        cache: false,
                                        data: {
                                            "p_str_cmp_id": p_str_cmp_id
                                        },

                                        dataType: "json",
                                        success: function (e) {
                                            $.each(e, function () {
                                                $("#g_str_tmp_cmp_id").val(p_str_cmp_id);
                                                //alert(p_str_cmp_id);
                                                //$("#tmp_cmp_id").val(this.l_str_tmp_cmp_id);
                                                //$("#cmp_id").val(this.l_str_tmp_cmp_id);
                                                //$("#g_str_tmp_cmp_id").val(this.l_str_tmp_cmp_id);

                                            });
                                        },
                                    });
                                });

                            });

                            function change(el) {
                                if (el.value === "(Click to hide...)")
                                    el.value = "(Click to show...)";
                                else
                                    el.value = "(Click to hide...)";
                            }

                            $('#btnCmpEmailTo').click(function () {
                                debugger
                                var lstrCmpEmailList = $('#emlCmpEmailTo').val();
                                var p_str_form_control = "emlCmpEmailTo";
                                var options = { "backdrop": "static", keyboard: true };
                                var p_str_cmp_id = $("#cmp_id").val();
                                var p_str_cmp_email_to = lstrCmpEmailList;
                                var pstrEmailType = 'CMP';
                                $("#ajaxLoading").show();
                                $.ajax({
                                    url: '@Url.Action("GetEmailList", "EmailSetup")',
                                    contentType: "application/json; charset=utf-8",
                                    type: 'GET',
                                    data: { "pstrCmpId": p_str_cmp_id, "pstrEmail": p_str_cmp_email_to, "pstrFormControl": p_str_form_control, "pstrEmailType": pstrEmailType },
                                    datatype: "json",
                                    success: function (data) {
                                        $('#UsersEmailContent').html(data);
                                        $('#UsersEmail').modal(options);
                                        $('#UsersEmail').modal('show');
                                        $("#ajaxLoading").hide();
                                    }
                                });

                            });

                            $('#btnCustEmailTo').click(function () {
                                debugger
                                var lstrCustEmailList = $('#emlCustEmailTo').val();
                                var p_str_form_control = "emlCustEmailTo";
                                var options = { "backdrop": "static", keyboard: true };
                                var p_str_cmp_id = $("#cmp_id").val();
                                var p_str_cust_email_to = lstrCustEmailList;
                                var pstrEmailType = 'CUST';
                                $("#ajaxLoading").show();
                                $.ajax({
                                    url: '@Url.Action("GetEmailList", "EmailSetup")',
                                    contentType: "application/json; charset=utf-8",
                                    type: 'GET',
                                    data: { "pstrCmpId": p_str_cmp_id, "pstrEmail": p_str_cust_email_to, "pstrFormControl": p_str_form_control, "pstrEmailType": pstrEmailType },
                                    datatype: "json",
                                    success: function (data) {
                                        $('#UsersEmailContent').html(data);
                                        $('#UsersEmail').modal(options);
                                        $('#UsersEmail').modal('show');
                                        $("#ajaxLoading").hide();
                                    }
                                });

                            });

                        </script>



